<?xml version="1.0"?>
<project name="joz-joz" default="no-default" basedir="..">

    <!-- NOTE WELL: This file is imported into the main build.xml file.
         It is not intended to work standalone.  -->

    <!-- ****************************************************************** -->

    <target name="build-Joz-jar" depends="init">

        <javac destdir="${classes.dir}"
               debug="on"
               optimize="on"
               srcdir="${src.dir}"
               includes="com/tumri/joz/*/*.java"
	       excludes="com/tumri/joz/testsuite/*.java">
            <classpath refid="project.class.path"/>
            <compilerarg value="-Xlint:unchecked"/>
	    <compilerarg value="-Xlint:deprecation"/>
        </javac>

        <delete dir="${stage.dir}/Joz"/>
        <mkdir dir="${stage.dir}/Joz"/>

        <!-- copy so it gets put into our jar -->
        <copy file="${src.dir}/log4j.properties"
              todir="${stage.dir}/Joz"/>


        <jar destfile="${dist.dir}/joz.jar">
            <fileset dir="${classes.dir}"
		     includes="com/tumri/joz/*/*.class"
		     excludes="com/tumri/joz/testsuite/*.class"/>
            <fileset dir="${stage.dir}/Joz"/>
            <manifest>
                <attribute name="Main-Class" value="com.tumri.joz.keywordServer.ProductIndex"/>
            </manifest>
        </jar>

    </target>

    <!-- ****************************************************************** -->

    <target name="build-Joz-war" depends="build-Joz-jar">

	<war destfile="${dist.dir}/joz.war" 
		webxml="${src.dir}/webresources/WEB-INF/web.xml">
	    <lib dir="${dist.dir}" includes="joz.jar"/>
	    <lib dir="${ext.lib.dir}" includes="*.jar">
	    	<exclude name="log4j*.jar"/>
	    	<exclude name="servlet-api.jar"/>
	    </lib>
	    <lib dir="${zini.lib.dir}" includes="zini.catalog.api.jar"/>
	    <lib dir="${utils.lib.dir}" includes="utils.jar"/>
	    <lib dir="${cma.lib.dir}" includes="cma.jar"/>
	    <lib dir="${caa.lib.dir}" includes="caa.jar"/>
	</war>

    </target>

</project>
